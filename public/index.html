<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Getani - AI Anime Image Generator</title>

  <!-- ‚úÖ Basic SEO -->
  <meta name="description" content="Generate stunning anime-style images using AI. Fast, free, and beautifully simple.">
  <meta name="keywords" content="AI anime generator, anime art, AI image generator, getani, anime factory">
  <meta name="author" content="Getani Team">

  <!-- ‚úÖ Open Graph (for Facebook, Discord, LinkedIn, etc.) -->
  <meta property="og:title" content="Getani - AI Anime Image Generator">
  <meta property="og:description" content="Create AI-generated anime characters in seconds.">
  <meta property="og:image" content="https://getani.net/og-image.png">
  <meta property="og:url" content="https://getani.net">
  <meta property="og:type" content="website">

  <!-- ‚úÖ Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Getani - AI Anime Generator">
  <meta name="twitter:description" content="Generate anime art using AI ‚Äì simple, fast, and free.">
  <meta name="twitter:image" content="https://getani.net/og-image.png">

  <!-- ‚úÖ Favicon -->
  <link rel="icon" href="/favicon.png" type="image/png" />

  <!-- ‚úÖ Fonts & Styles -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>

<style>
.form-container {
position: absolute;
top: 20vh; /* 75% of the viewport height */
left: 50%;
transform: translate(-50%, -50%);
width: 100%;
display: flex;
justify-content: center;
align-items: center;
z-index: 1;
}

.site-name-glass-orange {
  display: flex;
  align-items: center;
  font-family: 'Poppins', sans-serif;
  font-size: 2.2rem; /* ‚¨ÜÔ∏è Bigger text */
  font-weight: 800;
  color: #fff;
  text-decoration: none;
  padding: 0.3rem 0.6rem;
  border-radius: 14px;
  background: linear-gradient(135deg, rgba(255, 165, 0, 0.08), rgba(255, 100, 0, 0.12));
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  box-shadow: 0 6px 20px rgba(255, 140, 0, 0.3);
  transition: box-shadow 0.3s ease;
}

.site-name-glass-orange:hover {
  box-shadow: 0 8px 28px rgba(255, 140, 0, 0.45);
}

.glow-orange {
  color: #ffa500;
  text-shadow: 0 0 10px rgba(255, 165, 0, 0.5);
}






#image-feed {
display: flex;
flex-wrap: wrap;
gap: 1rem;
justify-content: center; /* or flex-start if you want left-align */
padding-top: 1rem;
}

#image-feed > div {
display: flex;
flex-direction: column;
align-items: stretch;
background: rgba(255, 255, 255, 0.04);
padding: 1rem;
border-radius: 16px;
max-width: 300px;
box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
transition: transform 0.2s ease;
overflow: hidden;
}

#image-feed img {
max-width: 100%;
border-radius: 12px;
margin-bottom: 0.75rem;
}
.card-buttons {
display: flex;
gap: 0.5rem;
margin-top: 0.75rem;
flex-wrap: wrap;
justify-content: center;
}
.action-btn {
padding: 0.5rem 1rem;
border-radius: 8px;
font-size: 0.95rem;
font-weight: 600;
text-decoration: none;
text-align: center;
border: none;
cursor: pointer;
transition: 0.3s ease all;
background: linear-gradient(135deg, #3b82f6, #6366f1);
color: white;
backdrop-filter: blur(8px);
-webkit-backdrop-filter: blur(8px);
box-shadow: 0 4px 15px rgba(0, 140, 255, 0.2);
}
.action-btn:hover {
background: linear-gradient(135deg, #2563eb, #4f46e5);
transform: translateY(-1px);
}
#auth-modal-content,
#generate-form,


#generate-form {
padding-top: 64px; /* match the header height */
background: transparent !important;
border: none !important;
backdrop-filter: none !important;
-webkit-backdrop-filter: none !important;
box-shadow: none !important;
}

body {
font-family: 'Inter', sans-serif;
color: #f0f0f0;
padding: 1rem;
display: flex;
flex-direction: column;
align-items: center;
position: relative;
overflow-x: hidden;
min-height: 100vh;
background: #1a1c2b; /* fallback solid color */
overflow-x: hidden;
}



.hidden { display: none !important; }
#image-feed > div {
margin-bottom: 1rem;
padding: 0.5rem;
background: #222;
border-radius: 8px;
}
#image-feed img {
max-width: 300px;
border-radius: 4px;
}
#progress-container {
background: #444;
border-radius: 6px;
overflow: hidden;
height: 20px;
margin: 1rem 0;
}
#progress-bar {
height: 100%;
width: 0%;
background: #0af;
transition: width 0.3s ease;
}
#cancel-btn {
background: #f33;
color: white;
border: none;
padding: 0.5rem 1rem;
border-radius: 4px;
margin-top: 0.5rem;
cursor: pointer;
}
.download-btn {
margin-top: 0.25rem;
display: inline-block;
background: #08f;
color: white;
padding: 0.25rem 0.5rem;
border: none;
border-radius: 4px;
text-decoration: none;
font-size: 0.9rem;
}
#top-header {
position: absolute;
top: 1rem;
right: 1rem;
z-index: 1000;
}

#top-header button {
background: #08f;
color: white;
border: none;
padding: 0.4rem 0.75rem;
margin-left: 0.5rem;
border-radius: 4px;
cursor: pointer;
}

#user-menu span {
margin-right: 0.5rem;
}
/* Center main content */
body {
font-family: 'Inter', sans-serif;
color: #eee;
padding: 1rem;
display: flex;
flex-direction: column;
align-items: center;
position: relative;
overflow-x: hidden;
min-height: 100vh;
z-index: 0;
}

body::before {
content: "";
position: fixed;
inset: 0;
background: radial-gradient(circle at top left, rgba(100, 150, 255, 0.2), transparent 60%),
radial-gradient(circle at bottom right, rgba(180, 100, 255, 0.15), transparent 60%),
radial-gradient(circle at center, rgba(255, 255, 255, 0.05), transparent 60%);
background-color: #1a1c2b; /* base color */
z-index: -1;
pointer-events: none;
filter: blur(24px) brightness(1.15);
}

@keyframes gradientShift {
0% {
background-position: 0% 50%;
}
50% {
background-position: 100% 50%;
}
100% {
background-position: 0% 50%;
}
}



/* Center and style prompt input */
/* Generate form layout */
#generate-form {
display: flex;
flex-direction: column;
align-items: stretch;
gap: 0rem;
width: 100%;
max-width: 600px;
}
#modal {
position: fixed;
inset: 0;
background: rgba(0, 0, 0, 0.8);
display: flex;
align-items: center;
justify-content: center;
z-index: 9999;
}

#modal-img {
max-width: 90%;
max-height: 90%;
border-radius: 12px;
box-shadow: 0 0 24px rgba(0, 0, 0, 0.6);
}

/* Prompt input styling */
#prompt-input {
border: none;
width: 94.5%;
padding: 1rem;
border-radius: 12px 12px 0 0;
border: 1px solid rgba(255, 255, 255, 0.1);
background: rgba(255, 255, 255, 0.05);
color: #fff;
font-size: 1rem;
font-family: 'Inter', sans-serif;
backdrop-filter: blur(12px);
box-shadow: inset 0 1px 3px rgba(255, 255, 255, 0.05);
transition: 0.3s ease;
resize: none;
}

#prompt-input:focus {
outline: none;
border-color: rgba(0, 140, 255, 0.4);
box-shadow: 0 0 8px rgba(0, 140, 255, 0.25);
}

/* Generate button - full width and animated */
#generate-form button[type="submit"] {
width: 100%;
padding: 1rem;
border: none;
border-radius: 0 0 12px 12px;
font-size: 1.1rem;
font-weight: 700;
background: linear-gradient(135deg, rgba(0,140,255,0.9), rgba(100,0,255,0.75));
color: white;
cursor: pointer;
position: relative;
overflow: hidden;
transition: background 0.3s ease, transform 0.2s ease;
box-shadow: 0 4px 15px rgba(0, 140, 255, 0.3);
display: flex;
justify-content: center;
align-items: center;
gap: 0.5rem;
backdrop-filter: blur(8px);
-webkit-backdrop-filter: blur(8px);
}

/* Sparkle/shine animation */
#generate-form button[type="submit"]::after {
content: "Login";
position: absolute;
top: -50%;
left: -50%;
width: 200%;
height: 200%;
background: radial-gradient(circle at center, rgba(255,255,255,0.25), transparent 60%);
transform: rotate(25deg);
animation: pulse-shine 2.5s infinite;
pointer-events: none;
}

@keyframes pulse-shine {
0% {
transform: translateX(-100%) rotate(25deg);
opacity: 0;
}
50% {
transform: translateX(0%) rotate(25deg);
opacity: 0.4;
}
100% {
transform: translateX(100%) rotate(25deg);
opacity: 0;
}
}

/* Hover effect */
#generate-form button[type="submit"]:hover {
transform: translateY(-2px);
box-shadow: 0 6px 20px rgba(0, 160, 255, 0.5);
}







/* Buttons - modern style */
button,
.download-btn {
background: rgba(255, 255, 255, 0.06);
color: #fff;
border: 1px solid rgba(255, 255, 255, 0.2);
border-radius: 10px;
padding: 0.6rem 1.2rem;
font-size: 1rem;
font-weight: 600;
font-family: 'Inter', sans-serif;
cursor: pointer;
backdrop-filter: blur(12px) saturate(180%);
-webkit-backdrop-filter: blur(12px) saturate(180%);
box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
transition: all 0.3s ease;
}

button:hover {
color: #fff;
background: rgba(0, 150, 255, 0.2);
border-color: rgba(0, 150, 255, 0.4);
box-shadow: 0 6px 24px rgba(0, 150, 255, 0.4);
}






/* Cancel button red variant */
#cancel-btn {
background: #f33;
}

#cancel-btn:hover {
background: #f55;
}

/* Auth buttons at top */
#top-header button {
background: #08f;
margin-left: 0.5rem;
}

#top-header button:hover {
background: #0af;
}
#auth-modal {
position: fixed;
inset: 0;
background: rgba(0, 0, 0, 0.8);
display: flex;
align-items: center;
justify-content: center;
z-index: 9999;
}

#auth-modal-content {
background: rgba(255, 255, 255, 0.05);
backdrop-filter: blur(20px);
-webkit-backdrop-filter: blur(20px);
border-radius: 16px;
padding: 2rem;
width: 100%;
max-width: 420px;
box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
border: 1px solid rgba(255, 255, 255, 0.15);
color: #fff;
font-family: 'Poppins', sans-serif;
}

#auth-modal-content input {
width: 100%;
padding: 0.8rem 1rem;
margin-bottom: 1rem;
border: 1px solid rgba(255, 255, 255, 0.2);
background: rgba(255, 255, 255, 0.08);
color: #fff;
border-radius: 10px;
font-size: 1rem;
outline: none;
}

#auth-modal-content input::placeholder {
color: #ccc;
}

#auth-modal-content button {
width: 100%;
padding: 0.75rem 1rem;
margin-top: 0.5rem;
font-size: 1rem;
font-weight: 600;
border: none;
border-radius: 10px;
cursor: pointer;
background: linear-gradient(135deg, #3b82f6, #6366f1);
color: white;
transition: background 0.3s ease;
}

#auth-modal-content button:hover {
background: linear-gradient(135deg, #2563eb, #4f46e5);
}

#auth-tabs {
display: flex;
justify-content: space-between;
margin-bottom: 1.5rem;
}

#auth-tabs button {
flex: 1;
background: transparent;
border: none;
color: #ccc;
padding: 0.5rem;
font-size: 1rem;
font-weight: bold;
cursor: pointer;
border-bottom: 2px solid transparent;
}

#auth-tabs button.active {
color: #fff;
border-bottom: 2px solid #3b82f6;
}

/* Footer styling */
.site-footer {
margin-top: auto;
padding: 1.5rem;
text-align: center;
color: #aaa;
font-size: 0.9rem;
background: rgba(255, 255, 255, 0.03);
border-top: 1px solid rgba(255, 255, 255, 0.08);
backdrop-filter: blur(6px);
-webkit-backdrop-filter: blur(6px);
box-shadow: 0 -2px 12px rgba(0, 0, 0, 0.1);
width: 100%;
}
.prompt-card {
display: flex;
flex-direction: column;
justify-content: center; /* vertically center */
align-items: center;     /* horizontally center */
min-height: 300px;
text-align: center;
}

.status-line {
font-size: 1rem;
color: #ccc;
font-style: italic;
}

.site-footer a {
color: #9ca3af; /* light gray-blue tone */
text-decoration: none;
margin: 0 0.5rem;
font-weight: 400;
}


.site-footer a:hover {
text-decoration: underline;
}

.site-footer .divider {
margin: 0 0.25rem;
color: #666;
}
html, body {
height: 100%;
}

body {
display: flex;
flex-direction: column;
}
#example-cards .prompt-card img {
max-width: 100%;
height: auto;
border-radius: 8px;
display: block;
}

#auth-tabs button.active {
color: #fff;
border-bottom: 2px solid #08f;
}
.prompt-box,
.prompt-box:hover,
.prompt-box:focus,
textarea,
textarea:hover,
textarea:focus,
input,
input:hover,
input:focus {
cursor: text !important;
}
/* Fixed full-width header */
.site-header {
position: fixed;
top: 0;
left: 0;
right: 0;
height: 64px;
display: flex;
justify-content: space-between;
align-items: center;
padding: 0 1.5rem; /* moderate padding */
background-color: #111827;
color: #f9fafb;
border-bottom: 1px solid #1f2937;
z-index: 1000;
box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
overflow-x: hidden;
}



/* Site name style */
.site-name {
font-size: 1.5rem;
font-weight: 700;
color: #f9fafb;
text-decoration: none;
}

/* Navigation links */
.header-center a {
margin: 0 1rem;
font-size: 1rem;
color: #d1d5db; /* lighter gray */
text-decoration: none;
font-weight: 500;
transition: color 0.2s;
}
.header-center a:hover {
color: #3b82f6; /* vibrant blue */
}
/* Right buttons */
.header-right .login-btn,
.header-right .signup-btn {
margin-left: 1rem;
padding: 0.5rem 1rem;
font-size: 0.95rem;
font-weight: 500;
border-radius: 6px;
cursor: pointer;
transition: all 0.2s ease;
border: none;
}

/* Login button - outline style */
.login-btn {
background-color: transparent;
color: #f9fafb;
border: 1px solid #4b5563;
}

.login-btn:hover {
background-color: #1f2937;
}

/* Signup button - primary style */
.signup-btn {
background-color: #3b82f6;
color: #fff;
}

.signup-btn:hover {
background-color: #2563eb;
}

.header-left {
display: flex;
align-items: center;
gap: 2rem;
}
.generating-status {
display: flex;
justify-content: center;
align-items: center;
min-height: 300px; /* same or similar height to an image */
text-align: center;
font-size: 1rem;
color: #ccc;
font-style: italic;
}

.header-nav a {
margin-right: 1rem;
font-size: 1rem;
color: #d1d5db;
text-decoration: none;
font-weight: 500;
transition: color 0.2s;
}

.header-nav a:hover {
color: #3b82f6;
}






.header-right {
display: flex;
align-items: center;
gap: 0.5rem;
flex-shrink: 0; /* prevents it from shrinking too much */
min-width: 0; /* allow content to shrink if necessary */
}
/* Ensure auth area stays right aligned */
.site-header {
display: flex;
justify-content: space-between;
align-items: center;
padding: 0 1rem;
width: 100%;
box-sizing: border-box;
overflow-x: hidden;
}

#auth-area {
display: flex;
align-items: center;
justify-content: flex-end;
gap: 0.5rem;
flex-shrink: 1;
flex-grow: 0;
min-width: 0;
overflow: hidden;
max-width: 100%;
}

#user-menu {
display: flex;
align-items: center;
white-space: nowrap;
text-overflow: ellipsis;
overflow: hidden;
min-width: 0;
flex-shrink: 1;
}

#logout-btn {
white-space: nowrap;
padding: 0.5rem 0.75rem;
font-size: 0.85rem;
flex-shrink: 0;
}





.card-section,
.card-grid {
display: flex;
flex-wrap: wrap;
gap: 1rem;
justify-content: center;
}

.prompt-card {
max-width: 300px;
width: 100%;
}

.prompt-card img {
width: 100%;
max-width: 300px;
height: auto;
object-fit: contain;
border-radius: 12px;
margin-bottom: 0.75rem;
}

.prompt-card:hover {
transform: scale(1.03);
}


.prompt-card img {
max-width: 100%;
}


.tooltip-container {
position: relative;
}

.tooltip-container::after {
content: "Click to copy prompt";
position: absolute;
top: 70%; /* Show below the card */
left: 50%;
transform: translateX(-50%);
margin-top: 6px; /* space below the card */
left: 50%;
transform: translateX(-50%);
background: rgba(0, 0, 0, 0.85);
color: #fff;
padding: 4px 8px;
border-radius: 6px;
font-size: 0.75rem;
white-space: nowrap;
opacity: 0;
pointer-events: none;
transition: opacity 0.2s ease;
z-index: 10;
}

.tooltip-container:hover::after {
opacity: 1;
}

.prompt-text {
padding: 0.75rem;
font-size: 0.9rem;
color: #f0f0f0;
text-align: center;
user-select: none;
}

.copied-toast {
position: absolute;
bottom: 8px;
right: 8px;
background: rgba(0, 200, 255, 0.7);
color: white;
font-size: 0.75rem;
padding: 0.2rem 0.5rem;
border-radius: 6px;
display: none;
}


#user-menu span {
margin-right: 0.5rem;
}
.site-name-glass {
font-family: 'Poppins', sans-serif;
font-size: 1.8rem;
font-weight: 700;
color: #fff;
text-decoration: none;
padding: 0.4rem 1rem;
border-radius: 12px;
background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(59, 130, 246, 0.1));
backdrop-filter: blur(12px) saturate(150%);
-webkit-backdrop-filter: blur(12px) saturate(150%);
box-shadow: 0 4px 16px rgba(59, 130, 246, 0.2);
display: inline-flex;
align-items: center;
gap: 0.25rem;
transition: all 0.3s ease;
}

.site-name-glass:hover {
box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);

}

.site-name-glass .glow {
color: #3b82f6;
font-weight: 800;
text-shadow: 0 0 6px rgba(59, 130, 246, 0.6);
}


.hamburger {
  display: none;
  font-size: 1.5rem;
  cursor: pointer;
  color: white;
}

@media (max-width: 768px) {
  .header-nav {
    display: none;
  }
  .hamburger {
    display: block;
  }
}

.mobile-menu {
  display: none;
  flex-direction: column;
  background-color: #111827;
  position: absolute;
  top: 64px;
  left: 0;
  right: 0;
  padding: 1rem;
  z-index: 999;
}

.mobile-menu.show {
  display: flex;
}
@media (max-width: 768px) {
  #auth-buttons button {
    display: none;
  }

  
}

@media (max-width: 768px) {
  .site-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    height: auto;
    padding: 0.5rem 1rem;
  }

  .header-left {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex: 1;
  }

  .header-right {
    margin-top: 0.5rem;
    width: 100%;
    display: flex;
    justify-content: flex-end;
  }

  #auth-buttons .login-btn,
  #auth-buttons .signup-btn {
    display: none;
  }

  #mobile-login-button {
    display: block;
    background-color: #3b82f6;
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-weight: 600;
    border: none;
    font-size: 0.95rem;
  }
}
.mobile-header-row {
  display: none;
}

@media (max-width: 768px) {
  .header-nav,
  #auth-buttons,
  .hamburger,
  .mobile-menu {
    display: none !important;
  }

  .site-header {
    flex-direction: column;
    align-items: flex-start;
    padding: 0.75rem 1rem;
  }

  .mobile-header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    margin-top: 0.5rem;
  }

  .mobile-membership-link {
    font-size: 1rem;
    font-weight: 600;
    color: #fff;
    text-decoration: none;
    background: none;
    border: none;
  }

  #mobile-login-button {
    background: #3b82f6;
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-weight: 600;
    font-size: 0.95rem;
    border: none;
    cursor: pointer;
  }
}

@media (max-width: 768px) {
  .header-nav {
    display: none;
  }

  #auth-buttons .signup-btn {
    display: none;
  }

  #auth-buttons .login-btn {
    display: none;
  }

  #mobile-login-button {
    display: block;
    background: #3b82f6;
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-weight: 600;
    font-size: 0.95rem;
    border: none;
    cursor: pointer;
  }

  .mobile-menu a {
    display: block;
    padding: 0.75rem 1rem;
    color: white;
    text-decoration: none;
    font-weight: 600;
  }

  .mobile-menu a:not(:last-child) {
    border-bottom: 1px solid #2d3748;
  }
}


@media (min-width: 769px) {
  #mobile-login-button {
    display: none;
  }
}
.mobile-header-row {
  display: none;
}

@media (max-width: 768px) {
  .mobile-header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    padding: 0.5rem 1rem;
    margin-top: 0.5rem;
  }

  .mobile-membership-link {
    font-size: 1rem;
    font-weight: 600;
    color: #fff;
    text-decoration: none;
  }

  #mobile-login-button {
    background: #3b82f6;
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-weight: 600;
    font-size: 0.95rem;
    border: none;
    cursor: pointer;
  }

  .header-nav,
  #auth-buttons {
    display: none !important;
  }
}
@media (max-width: 768px) {
  body {
    padding-top: 96px; /* header (64px) + row below (approx 32px) */
  }
}
@media (max-width: 768px) {
  #generate-form {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    padding: 0 1rem;
    width: 100%;
    max-width: 600px;
    margin-top: 1rem;
  }

  #prompt-input,
  #generate-form button[type="submit"] {
    width: 100%; /* üëà force both to match width */
    max-width: 100%;
    box-sizing: border-box;
  }
}
@media (max-width: 768px) {
  .header-left {
    display: none !important; /* üö´ Hide logo area */
  }

  .site-header {
    height: 56px; /* üîΩ Reduce header height */
    padding: 0.25rem 1rem; /* tighter spacing */
  }

  .header-right {
    margin-top: 0; /* remove unnecessary spacing */
    justify-content: flex-end;
  }

  .header-nav {
    justify-content: flex-start;
  }
}

</style>
</head>
<body>
<header class="site-header">
  <div class="header-left">
   <a href="/" class="site-name-glass-orange">
      <span class="brand-text">Get<span class="glow-orange">Ani</span></span>
    </a>
  </div>

  <nav class="header-nav">
    <a href="/">Generate</a>
    <a href="/membership">Membership</a>
  </nav>

  <!-- Mobile-only second row -->
  <div class="mobile-header-row">
    <div id="mobile-user-info" style="display: none; margin-top: 0.5rem; font-size: 0.95rem; color: white; font-weight: 500;">
  <span id="mobile-user-email"></span> ¬∑<i class="fas fa-gem" style="color:#3b82f6; margin-left: 6px; margin-right: 4px;"></i> <span id="mobile-user-credits"></span> credits
</div>

    <a href="/membership" class="mobile-membership-link">Membership</a>
    <button id="mobile-login-button" class="signup-btn">Log In</button>
  </div>

  <div class="header-right" id="auth-area">
    <div id="auth-buttons">
      <button id="show-login" class="login-btn">Log In</button>
      <button id="show-signup" class="signup-btn">Sign Up</button>
    </div>

    <div id="user-menu" class="hidden">
      <span id="user-email"></span>
      <button id="logout-btn" class="login-btn">Log Out</button>
    </div>
  </div>
</header>


<div id="auth-modal" class="hidden">
<div id="auth-modal-content">
<div id="auth-tabs">
<button id="tab-signup" class="active">Sign Up</button>
<button id="tab-login">Log In</button>
</div>
<input id="email" type="email" placeholder="Email" />
<input id="password" type="password" placeholder="Password" />
<button id="auth-submit">Submit</button>
<button id="auth-cancel" type="button">Cancel</button>
<hr style="margin: 1rem 0; border-color: rgba(255,255,255,0.1);" />

<button id="google-login" class="signup-btn" style="margin-top: 1rem;">
  <i class="fab fa-google" style="margin-right: 6px;"></i> Sign in with Google
</button>

<p id="modal-status"></p>
</div>
</div>


<form id="generate-form">
<textarea id="prompt-input" placeholder="Enter prompt..." rows="3"></textarea>
<button type="submit">‚ú® Generate</button>
</form>
<div id="progress-container" class="hidden">
<div id="progress-bar"></div>
</div>

<p id="status"></p>
<p id="status-message" class="status-line"></p>
<div id="image-feed"></div>
<div id="image-sections" style="margin-top: 2rem; width: 100%; max-width: 960px;">
<div id="user-images-section" class="card-section"></div>
<h2 style="margin-top: 2rem;">Try these examples</h2>
<div id="example-cards" class="card-grid"></div>
</div>

<div id="modal" class="hidden">


<img id="modal-img" src="" style="max-width: 90%; max-height: 90%;" />
</div>

<script type="module">

function escapeHtml(text) {
return text
.replace(/&/g, "&amp;")
.replace(/</g, "&lt;")
.replace(/>/g, "&gt;")
.replace(/"/g, "&quot;")
.replace(/'/g, "&#039;");
}
const statusMessage = document.getElementById("status-message");

const examplePrompts = [
{
prompt: "castle on a hill, lightning, nighttime, purple sky, moon, torch lit path leading up to the castle",
img: "/examples/castle.png"
},
{
prompt: "1girl, blue_hair, field landscape, summer outfit, standing in front of a wood windmill",
img: "/examples/windmill.png"
},
{
prompt: "river, sunny day, selfie from above, 1girl, green sweater, black shorts, wood dock, sunshine",
img: "/examples/selfie.png"
}
];
window.addEventListener("DOMContentLoaded", () => {
  renderExampleCards();

  // Google login button logic
  const googleLoginBtn = document.getElementById("google-login");
  if (googleLoginBtn) {
    googleLoginBtn.addEventListener("click", async () => {
      const provider = new GoogleAuthProvider();
      try {
        const result = await signInWithPopup(auth, provider);
        console.log("‚úÖ Google sign-in success:", result.user);

        // Create Firestore doc if needed
        const userRef = doc(firestore, "users", result.user.uid);
        const userSnap = await getDoc(userRef);
        if (!userSnap.exists()) {
          await setDoc(userRef, {
            credits: 10,
            plan: "free",
            lastRenewed: serverTimestamp(),
          });
        }

        // Hide modal and reset fields
        authModal.classList.add("hidden");
        emailInput.value = "";
        passwordInput.value = "";
        modalStatus.textContent = "";
      } catch (error) {
        console.error("‚ùå Google login failed:", error.message);
        modalStatus.textContent = "Google sign-in failed: " + error.message;
      }
    });
  }
});
async function resumePendingJobs() {
  if (!auth.currentUser) return;

  const pendingJobs = JSON.parse(localStorage.getItem("pendingJobs") || "[]");

  for (const job of pendingJobs) {
    try {
      console.log("Resuming job", job.jobId);
      const res = await fetch(`${BACKEND_URL}/api/job/${job.jobId}`);
      const text = await res.text();
      console.log("Raw response:", text);

      const data = JSON.parse(text);
      const jobData = data.job;

     if (["WAITING", "QUEUED", "RUNNING"].includes(jobData?.status)){

        const placeholder = document.createElement("div");
        placeholder.classList.add("prompt-card");
        placeholder.innerHTML = `<div class="status-line">‚è≥ Resuming job...</div>`;
        imageFeed.prepend(placeholder);
        const statusTracker = { highestPriority: 0 };
        pollJobStatus(
          job.jobId,
          0,
          job.prompt,
          (url) => {
            placeholder.innerHTML = `
              <img src="${url}" />
              <div>
                <small><b>Prompt:</b> ${escapeHtml(job.prompt)}</small><br>
                <div class="card-buttons">
                  <button class="action-btn download-btn" data-url="${url}">Download</button>
                </div>
              </div>
            `;
          },
          statusTracker,
          placeholder
        );
      } else {
        removeJob(job.jobId);
      }
    } catch (err) {
      console.error("‚ùå resumePendingJobs error:", err.message);
    }
  }
}



function renderExampleCards() {
const container = document.getElementById("example-cards");
examplePrompts.forEach(({ prompt, img }) => {
const card = document.createElement("div");
card.className = "prompt-card tooltip-container";

const image = document.createElement("img");
image.src = img;

const text = document.createElement("div");
text.className = "prompt-text";
text.textContent = prompt;

const toast = document.createElement("div");
toast.className = "copied-toast";
toast.textContent = "Copied!";

card.appendChild(image);
card.appendChild(text);
card.appendChild(toast);

card.onclick = () => {
navigator.clipboard.writeText(prompt);
toast.style.display = "block";
setTimeout(() => (toast.style.display = "none"), 1000);
};

container.appendChild(card);
});
}





import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import {
getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword,
onAuthStateChanged, signOut,
setPersistence, browserLocalPersistence,
  GoogleAuthProvider,
  signInWithPopup,
  sendEmailVerification
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

import {
getFirestore, collection, doc, addDoc, getDocs, orderBy, query,
deleteDoc, serverTimestamp, getDoc, setDoc, updateDoc, increment
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

import {
getStorage, ref, deleteObject, uploadBytes, getDownloadURL
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-storage.js";


const firebaseConfig = {
  apiKey: "AIzaSyCwV5ALTmOs3bSaHR0nR5nXV5TJ783bj9A",
  authDomain: "getani-ba76e.firebaseapp.com",
  projectId: "getani-ba76e",
  storageBucket: "getani-ba76e.firebasestorage.app",
  messagingSenderId: "940208374805",
  appId: "1:940208374805:web:3491bd6a9663f8d2533a1c",
  measurementId: "G-E2H6T0J8M1"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
import { applyActionCode } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

async function handleEmailVerificationRedirect() {
  const urlParams = new URLSearchParams(window.location.search);
  const mode = urlParams.get("mode");
  const oobCode = urlParams.get("oobCode");

  if (mode === "verifyEmail" && oobCode) {
    try {
      await applyActionCode(auth, oobCode);
      console.log("‚úÖ Email verified successfully!");
      window.history.replaceState({}, document.title, "/"); // Clean URL
      alert("‚úÖ Your email has been verified!");
      await auth.currentUser.reload(); // update status
    } catch (error) {
      console.error("‚ùå Failed to apply verification code:", error.message);
      alert("‚ùå Verification link is invalid or expired.");
    }
  }
}

setPersistence(auth, browserLocalPersistence).catch((err) => {
console.error("Failed to set persistence:", err);
});

const firestore = getFirestore(app);
const storage = getStorage(app); // auto-uses the correct bucket from `firebaseConfig`

const authButtons = document.getElementById("auth-buttons");
const userMenu = document.getElementById("user-menu");
const userEmail = document.getElementById("user-email");
const logoutBtn = document.getElementById("logout-btn");
const authModal = document.getElementById("auth-modal");
const emailInput = document.getElementById("email");
const passwordInput = document.getElementById("password");
const authSubmit = document.getElementById("auth-submit");
const authCancel = document.getElementById("auth-cancel");
const modalStatus = document.getElementById("modal-status");
const generateForm = document.getElementById("generate-form");
const imageFeed = document.getElementById("image-feed");
const statusP = document.getElementById("status");
const showSignupBtn = document.getElementById("show-signup");
const showLoginBtn = document.getElementById("show-login");
const progressContainer = document.getElementById("progress-container");
const progressBar = document.getElementById("progress-bar");

let authAction = null;

let currentCredits = 0; // will be updated after login

authCancel.onclick = () => {
authModal.classList.add("hidden");
emailInput.value = "";
passwordInput.value = "";
modalStatus.textContent = "";
};





authSubmit.onclick = async () => {
const email = emailInput.value.trim();
const password = passwordInput.value.trim();

if (!authAction) {
modalStatus.textContent = "Please select Sign Up or Log In.";
return;
}

if (!email || !password) {
modalStatus.textContent = "Email and password required.";
return;
}

try {
if (authAction === "signup") {
  const userCredential = await createUserWithEmailAndPassword(auth, email, password);
  await sendEmailVerification(userCredential.user);
  modalStatus.textContent = "‚úÖ Verification email sent. Please check your inbox.";
}
 else {
await signInWithEmailAndPassword(auth, email, password);
}
console.log("Auth successful, hiding modal");
authModal.classList.add("hidden");  // ‚úÖ This is your actual hide
emailInput.value = "";
passwordInput.value = "";
modalStatus.textContent = "";
} catch (e) {
  console.error("Auth error:", e.message);

  let message = "‚ùå Login failed.";

  switch (e.code) {
    case "auth/invalid-login-credentials":
    case "auth/wrong-password":
    case "auth/user-not-found":
      message = "‚ùå Incorrect email or password.";
      break;
    case "auth/email-already-in-use":
      message = "‚ùå This email is already in use.";
      break;
    case "auth/too-many-requests":
      message = "‚ùå Too many attempts. Please try again later.";
      break;
    case "auth/network-request-failed":
      message = "‚ùå Network error. Please check your connection.";
      break;
    default:
      message = "‚ùå " + e.message.replace("Firebase: ", "").replace(/\(.*\)\./, "").trim();
  }

  modalStatus.textContent = message;
}

};
logoutBtn.onclick = async () => {
await signOut(auth);
};

onAuthStateChanged(auth, async (user) => {
  if (user) {
    
    const mobileLoginBtn = document.getElementById("mobile-login-button");
if (mobileLoginBtn) {
  mobileLoginBtn.style.display = user ? "none" : "block";
}
    authButtons.classList.add("hidden");
    userMenu.classList.remove("hidden");

    const userRef = doc(firestore, "users", user.uid);

    let userSnap = await getDoc(userRef);

    // Create user doc if it doesn't exist
    if (!userSnap.exists()) {
      await setDoc(userRef, {
        credits: 10,
        plan: "free",
        lastRenewed: serverTimestamp(),
      });
      userSnap = await getDoc(userRef);
    }

    const userData = userSnap.data();
    const lastRenewed = userData.lastRenewed?.toDate?.();
    const now = new Date();

    // Monthly credit reset
    if (lastRenewed) {
      const msSinceRenewal = now - lastRenewed;
      const thirtyDays = 30 * 24 * 60 * 60 * 1000;
      if (msSinceRenewal > thirtyDays) {
        let newCredits = 0;
        if (userData.plan === "basic") newCredits = 300;
        if (userData.plan === "pro") newCredits = 600;
        if (userData.plan === "premium") newCredits = 1000;

        await updateDoc(userRef, {
          credits: newCredits,
          lastRenewed: serverTimestamp(),
        });

        currentCredits = newCredits;
      } else {
        currentCredits = userData.credits;
      }
    } else {
      currentCredits = userData.credits;
    }

    userEmail.innerHTML = `
      ${user.email}
      <i class="fas fa-gem" style="color:#3b82f6; margin-left: 8px;"></i> ${currentCredits} credits
    `;

const mobileUserInfo = document.getElementById("mobile-user-info");
const mobileEmail = document.getElementById("mobile-user-email");
const mobileCredits = document.getElementById("mobile-user-credits");

if (mobileLoginBtn) mobileLoginBtn.style.display = "none";

if (mobileUserInfo && mobileEmail && mobileCredits) {
  mobileUserInfo.style.display = "block";
  mobileEmail.textContent = user.email;
  mobileCredits.textContent = currentCredits;
}

    // ‚úÖ 1. Show loading cards for any pending jobs first
    await resumePendingJobs();

    // ‚úÖ 2. Load completed user images second (won‚Äôt clear placeholders)
    await loadUserImages(user.uid);

    // ‚úÖ 3. Set up modal image viewing
    

  }
  
  else {
    
const mobileUserInfo = document.getElementById("mobile-user-info");

if (mobileLoginBtn) mobileLoginBtn.style.display = "block";
if (mobileUserInfo) mobileUserInfo.style.display = "none";

    const mobileLoginBtn = document.getElementById("mobile-login-button");
if (mobileLoginBtn) {
  mobileLoginBtn.style.display = user ? "none" : "block";
}
    authButtons.classList.remove("hidden");
    userMenu.classList.add("hidden");

    // ‚úÖ Only remove user-generated cards, not placeholders
    const generatedCards = imageFeed.querySelectorAll(".prompt-card img");
    generatedCards.forEach(img => {
      const card = img.closest(".prompt-card");
      card?.remove();
    });
  }
});


function saveJob(jobId, prompt) {
const jobs = JSON.parse(localStorage.getItem("pendingJobs") || "[]");
jobs.push({ jobId, prompt });
localStorage.setItem("pendingJobs", JSON.stringify(jobs));
}

function removeJob(jobId) {
const jobs = JSON.parse(localStorage.getItem("pendingJobs") || "[]");
const updated = jobs.filter(j => j.jobId !== jobId);
localStorage.setItem("pendingJobs", JSON.stringify(updated));
}

generateForm.onsubmit = async (e) => {
e.preventDefault();

const prompt = document.getElementById("prompt-input").value.trim();
if (!auth.currentUser) {
  authAction = "login";
  authModal.classList.remove("hidden");
  modalStatus.textContent = "Please log in to generate images.";
  return;
}

await auth.currentUser.reload();
if (!auth.currentUser.emailVerified) {
  statusP.textContent = "‚ùå Please verify your email before generating images.";
  return;
}



if (!auth.currentUser) {
authAction = "login";
authModal.classList.remove("hidden");
modalStatus.textContent = "Please log in to generate images.";
return;
}

if (!prompt) {
statusP.textContent = "Enter a prompt.";
return;
}

if (/[<>]/.test(prompt)) {
statusP.textContent = "‚ùå Prompt cannot contain < or > characters.";
return;
}
statusP.textContent = "‚ú® Submitting generation...";

const userDoc = await getDoc(doc(firestore, "users", auth.currentUser.uid));
const userData = userDoc.data();
if (currentCredits < 2) {
statusP.textContent = "‚ùå You need at least 2 credits to generate 2 images.";
return;
}

await updateDoc(doc(firestore, "users", auth.currentUser.uid), {
credits: increment(-2),
});
currentCredits -= 2;
userEmail.textContent = `${auth.currentUser.email} (${currentCredits} credits)`;

progressContainer.classList.remove("hidden");
progressBar.style.width = "0%";
//statusP.textContent = "Submitting 2 jobs...";

const idToken = await auth.currentUser.getIdToken();

try {
const [res1, res2] = await Promise.all([
fetch(`${BACKEND_URL}/api/generate`, {

method: "POST",
headers: {
"Content-Type": "application/json",
Authorization: `Bearer ${idToken}`,
},
body: JSON.stringify({ prompt }),
}),
fetch(`${BACKEND_URL}/api/generate`, {

method: "POST",
headers: {
"Content-Type": "application/json",
Authorization: `Bearer ${idToken}`,
},
body: JSON.stringify({ prompt }),
}),
]);

const data1 = await res1.json();
const data2 = await res2.json();

if (!res1.ok || !res2.ok) throw new Error("One of the jobs failed to submit.");

saveJob(data1.jobId, prompt);
saveJob(data2.jobId, prompt);

const completed = { count: 0 };
const statusTracker = { highestPriority: 0 };

const onComplete = async (imageUrl, placeholderDiv) => {
placeholderDiv.innerHTML = `
       <img src="${imageUrl}" />
       <div>
         <small><b>Prompt:</b> ${escapeHtml(prompt)}</small><br>
         <small>Generated just now (expires in ~1h)</small>
         <div class="card-buttons">
           <button class="action-btn download-btn" data-url="${imageUrl}">Download</button>
          
         </div>
       </div>
     `;


completed.count++;
if (completed.count === 2) {
mostRecentJobStatus = "";
statusP.textContent = "";
progressContainer.classList.add("hidden");
}
};

const placeholder1 = document.createElement("div");
placeholder1.classList.add("prompt-card");
placeholder1.innerHTML = `
   <div class="prompt-text">üõ†Ô∏è Generating image 1...</div>
 <div class="status-line">‚è≥ In queue ‚Äì waiting to start...</div>
`;

imageFeed.prepend(placeholder1);
const placeholder2 = document.createElement("div");
placeholder2.classList.add("prompt-card");
placeholder2.innerHTML = `
 <div class="prompt-text">üõ†Ô∏è Generating image 2...</div>
 <div class="status-line">‚è≥ In queue ‚Äì waiting to start...</div>
`;
imageFeed.prepend(placeholder2);
statusP.textContent = ""; // ‚úÖ Clear submission message
pollJobStatus(data1.jobId, 0, prompt, (url) => onComplete(url, placeholder1), statusTracker, placeholder1);
pollJobStatus(data2.jobId, 0, prompt, (url) => onComplete(url, placeholder2), statusTracker, placeholder2);



} catch (err) {
statusP.textContent = "Error: " + err.message;
progressContainer.classList.add("hidden");
}
};





let mostRecentJobStatus = "";


function dataURLtoBlob(dataUrl) {
const arr = dataUrl.split(',');
const mime = arr[0].match(/:(.*?);/)[1];
const bstr = atob(arr[1]);
let n = bstr.length;
const u8arr = new Uint8Array(n);
while (n--) {
u8arr[n] = bstr.charCodeAt(n);
}
return new Blob([u8arr], { type: mime });
}

async function pollJobStatus(jobId, attempt = 0, prompt = "", onComplete = null, statusTracker = { highestPriority: 0 }, placeholderDiv = null) {
const MAX_ATTEMPTS = 500;
const POLL_INTERVAL = 3000;
const userId = auth.currentUser.uid;
const userDoc = await getDoc(doc(firestore, "users", userId));
const userPlan = userDoc.data().plan || 'free';

let secondsElapsed = 0;
const interval = setInterval(() => {
secondsElapsed++;
const minutes = String(Math.floor(secondsElapsed / 60)).padStart(2, '0');
const secondsStr = String(secondsElapsed % 60).padStart(2, '0');
const formattedTime = `${minutes}:${secondsStr}`;
if (placeholderDiv) {
const statusEl = placeholderDiv.querySelector(".status-line");
if (statusEl) {
const liveStatus = placeholderDiv.dataset.jobStatusText || "‚è≥ Working...";
statusEl.textContent = `${liveStatus} ‚Ä¢ ${formattedTime}`;
}
}

if (secondsElapsed === 90) {
statusP.textContent = "Server is experiencing high demand. Try submitting another generation to speed up the queue."
}
}, 1000);

async function poll(attempt) {
if (attempt >= MAX_ATTEMPTS) {
clearInterval(interval);
progressContainer.classList.add("hidden");
statusP.textContent = "‚ùå Job timed out. Please try again.";
return;
}

try {
const res = await fetch(`${BACKEND_URL}/api/job/${jobId}`);
const data = await res.json();
const job = data.job;

console.log("üéØ Job status:", job?.status, job);

progressBar.style.width = `${Math.min(((attempt + 1) / MAX_ATTEMPTS) * 100, 100)}%`;

const status = job?.status || "UNKNOWN";
const statusMap = {
QUEUED: "‚è≥ In queue ‚Äì waiting to start...",
RUNNING: "üîÑ Generating ‚Äì image in progress...",
SUCCESS: "‚úÖ Success!",
FAILED: "‚ùå Generation failed.",
};
if (placeholderDiv) placeholderDiv.dataset.jobStatusText = statusMap[status] || "‚è≥ Working...";

if (status === "SUCCESS") {
clearInterval(interval);
removeJob(jobId);
if (placeholderDiv) {
  placeholderDiv.dataset.jobStatusText = "‚úÖ Image generated ‚Äì loading preview...";
}

let imageUrl = job.successInfo?.images?.[0]?.url;
let finalUrl = imageUrl;
let storagePathSaved = null;

try {
  const storagePath = `users/${userId}/${jobId}.png`;
  const imageRef = ref(storage, storagePath);

  if (userPlan === "free" || userPlan === "basic") {
    // Watermark + upload
    finalUrl = await addWatermark(imageUrl);
    const blob = dataURLtoBlob(finalUrl);
    await uploadBytes(imageRef, blob);
    finalUrl = await getDownloadURL(imageRef);
    storagePathSaved = storagePath;
    console.log("‚úÖ Uploaded watermarked image:", finalUrl);
  } else {
    // Just re-encode + upload
    const blob = await reencodeImageToBlob(imageUrl);
    await uploadBytes(imageRef, blob);
    finalUrl = await getDownloadURL(imageRef);
    storagePathSaved = storagePath;
    console.log("‚úÖ Uploaded premium image (no watermark):", finalUrl);
  }
} catch (err) {
  console.warn("‚ùå Image upload failed:", err.message);
  finalUrl = imageUrl; // fallback to original CDN URL
}


await addDoc(collection(firestore, "users", userId, "images"), {
url: finalUrl,
prompt,
path: storagePathSaved,
createdAt: serverTimestamp(),
});

if (onComplete) onComplete(finalUrl, placeholderDiv);
} else if (status === "FAILED") {
clearInterval(interval);
removeJob(jobId);
progressContainer.classList.add("hidden");
statusP.textContent = "‚ùå Generation failed.";
} else {
setTimeout(() => poll(attempt + 1), POLL_INTERVAL);
}

} catch (err) {
clearInterval(interval);
console.error("‚ùå Polling error:", err);
statusP.textContent = `‚ùå Polling error: ${err.message}`;
progressContainer.classList.add("hidden");
}
}

poll(attempt);
}


async function reencodeImageToBlob(imageUrl) {
  return new Promise((resolve, reject) => {
    const img = new Image();
    img.crossOrigin = "anonymous";
    img.src = `https://getani.kappalol321.workers.dev/?url=${encodeURIComponent(imageUrl)}`;


    img.onload = () => {
      const canvas = document.createElement("canvas");
      canvas.width = img.width;
      canvas.height = img.height;
      const ctx = canvas.getContext("2d");
      ctx.drawImage(img, 0, 0);
      canvas.toBlob(blob => {
        if (blob) resolve(blob);
        else reject(new Error("Canvas toBlob failed"));
      }, "image/png");
    };

    img.onerror = () => reject(new Error("Image failed to load (reencoding)"));
  });
}


async function addWatermark(imageUrl) {
  return new Promise((resolve, reject) => {
    const img = new Image();
    img.crossOrigin = "anonymous";
    img.src = `https://getani.kappalol321.workers.dev/?url=${encodeURIComponent(imageUrl)}`;

    img.onload = () => {
      const canvas = document.createElement("canvas");
      canvas.width = img.width;
      canvas.height = img.height;
      const ctx = canvas.getContext("2d");

      // Draw the base image
      ctx.drawImage(img, 0, 0);

      // Watermark settings (match server-side logic)
      const fontSize = Math.floor(canvas.width * 0.035);
      ctx.font = `bold ${fontSize}px Poppins, sans-serif`;  // include fallback
      ctx.textAlign = "right";
      ctx.textBaseline = "bottom";

      const padding = canvas.width * 0.02;
      const text = "getani.net"; // lowercase to match script

      // Stroke (black outline)
      ctx.lineWidth = 4;
      ctx.strokeStyle = "rgba(0, 0, 0, 0.8)";
      ctx.strokeText(text, canvas.width - padding, canvas.height - padding);

      // Fill (white text)
      ctx.fillStyle = "rgba(255, 255, 255, 0.95)";
      ctx.fillText(text, canvas.width - padding, canvas.height - padding);

      resolve(canvas.toDataURL("image/png"));
    };

    img.onerror = () => {
      reject(new Error("Image failed to load (likely expired or CORS-restricted)"));
    };
  });
}




const tabSignup = document.getElementById("tab-signup");
const tabLogin = document.getElementById("tab-login");

tabSignup.onclick = () => {
authAction = "signup";
tabSignup.classList.add("active");
tabLogin.classList.remove("active");
modalStatus.textContent = "";
};

tabLogin.onclick = () => {
authAction = "login";
tabLogin.classList.add("active");
tabSignup.classList.remove("active");
modalStatus.textContent = "";
};

showSignupBtn.onclick = () => {
authAction = "signup";
tabSignup.classList.add("active");
tabLogin.classList.remove("active");
authModal.classList.remove("hidden");
modalStatus.textContent = "";
};

showLoginBtn.onclick = () => {
authAction = "login";
tabLogin.classList.add("active");
tabSignup.classList.remove("active");
authModal.classList.remove("hidden");
modalStatus.textContent = "";
};
async function loadUserImages(userId) {
  const q = query(
    collection(firestore, "users", userId, "images"),
    orderBy("createdAt", "desc")
  );
  const querySnapshot = await getDocs(q);

  // ‚úÖ Do not wipe the feed ‚Äî just add a loading line
  const loadingMsg = document.createElement("p");
  loadingMsg.className = "status-line";
  loadingMsg.id = "resuming-status"; // ‚úÖ Give it a unique ID
  loadingMsg.textContent = "üîÑ Resuming generation...";
  imageFeed.appendChild(loadingMsg);

  for (const docSnap of querySnapshot.docs) {
    const data = docSnap.data();
    const imageUrl = data.url;

    const div = document.createElement("div");
    div.classList.add("prompt-card");
    div.innerHTML = `
      <img src="${imageUrl}" />
      <div>
        <small><b>Prompt:</b> ${escapeHtml(data.prompt)}</small><br>
        <div class="card-buttons">
          <button class="action-btn download-btn" data-url="${imageUrl}">Download</button>
        </div>
      </div>
    `;

    imageFeed.appendChild(div);
  }

  // ‚úÖ Remove loading text only
  imageFeed.querySelector(".status-line")?.remove();
  // Remove the loading message if it exists
const msg = document.getElementById("resuming-status");
if (msg) msg.remove();

}




imageFeed.addEventListener("click", async (e) => {
if (e.target.classList.contains("download-btn")) {
const url = e.target.getAttribute("data-url");

try {
// If it's already a data URL (from canvas watermark), download directly
if (url.startsWith("data:image")) {
const a = document.createElement("a");
a.href = url;
a.download = "image.png";
document.body.appendChild(a);
a.click();
document.body.removeChild(a);
return;
}

// Otherwise, fetch as blob (for normal external URLs)
const response = await fetch(url, { mode: "cors" });
const blob = await response.blob();

const blobUrl = URL.createObjectURL(blob);
const a = document.createElement("a");
a.href = blobUrl;
a.download = "image.png";
document.body.appendChild(a);
a.click();
document.body.removeChild(a);
URL.revokeObjectURL(blobUrl);
} catch (err) {
console.error("Download failed:", err);
alert("‚ùå Could not download image.");
}
}
});

const modal = document.getElementById("modal");
    const modalImg = document.getElementById("modal-img");

    imageFeed.addEventListener("click", (e) => {
      if (e.target.tagName === "IMG") {
        modalImg.src = e.target.src;
        modal.classList.remove("hidden");
      }
    });

    modal.addEventListener("click", () => {
      modal.classList.add("hidden");
    });

// Close the modal when clicked
modal.onclick = () => modal.classList.add("hidden");




const BACKEND_URL = "https://api.getani.net";


async function testAPI() {
try {
const res = await fetch(`${BACKEND_URL}/api/job/test`);
const text = await res.text();
console.log("‚úÖ RESPONSE TEXT:", text);
} catch (e) {
console.error("‚ùå TEST ERROR:", e);
}
}

document.addEventListener('DOMContentLoaded', () => {
  const mobileLogin = document.getElementById('mobile-login-button');
  if (mobileLogin) {
    mobileLogin.addEventListener('click', () => {
      authAction = 'login';
      document.getElementById('tab-login').classList.add('active');
      document.getElementById('tab-signup').classList.remove('active');
      document.getElementById('auth-modal').classList.remove('hidden');
      document.getElementById('modal-status').textContent = '';
    });
  }
});
handleEmailVerificationRedirect();



</script>
<div style="text-align: center; margin: 40px 0;">
  

</div>

<footer class="site-footer">
<a href="/terms.html">Terms of Service</a>
<span class="divider">|</span>
<a href="/privacy.html">Privacy Policy</a>
<span class="divider">|</span>
<a href="mailto:contact@getani.net">Contact: contact@getani.net</a>
</footer>


</body>
</html>